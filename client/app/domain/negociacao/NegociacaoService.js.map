{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoService.js"],"names":["HttpService","Negociacao","ApplicationException","NegociacaoService","constructor","_http","obterNegociacoesDaSemana","get","then","dados","map","dado","Date","data","quantidade","valor","err","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaRetrasada","obtemNegociacoesDoPeriodo","periodo","Promise","all","reduce","acc","array","concat","sort","a","b","getTime","_mensagem","texto"],"mappings":";;;;;;AAASA,iB,sBAAAA,W;;AACAC,gB,iBAAAA,U;;AACAC,0B,+BAAAA,oB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UACIC,iB,GAAN,MAAMA,iBAAN,CAAwB;AAC7BC,sBAAc;AACZ,eAAKC,KAAL,GAAa,IAAIL,WAAJ,EAAb;AACD;;AAEDM,mCAA2B;AACzB,iBAAO,KAAKD,KAAL,CAAWE,GAAX,CAAe,oBAAf,EAAqCC,IAArC,CACJC,KAAD,IACEA,MAAMC,GAAN,CACGC,IAAD,IACE,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,KAAKE,IAAd,CAAf,EAAoCF,KAAKG,UAAzC,EAAqDH,KAAKI,KAA1D,CAFJ,CAFG,EAMJC,GAAD,IAAS;AACP,kBAAM,IAAId,oBAAJ,CACJ,iDADI,CAAN;AAGD,WAVI,CAAP;AAYD;;AAEDe,2CAAmC;AACjC,iBAAO,KAAKZ,KAAL,CAAWE,GAAX,CAAe,sBAAf,EAAuCC,IAAvC,CACJC,KAAD,IACEA,MAAMC,GAAN,CACGC,IAAD,IACE,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,KAAKE,IAAd,CAAf,EAAoCF,KAAKG,UAAzC,EAAqDH,KAAKI,KAA1D,CAFJ,CAFG,EAMJC,GAAD,IAAS;AACP,kBAAM,IAAId,oBAAJ,CACJ,0DADI,CAAN;AAGD,WAVI,CAAP;AAYD;;AAEDgB,4CAAoC;AAClC,iBAAO,KAAKb,KAAL,CAAWE,GAAX,CAAe,uBAAf,EAAwCC,IAAxC,CACJC,KAAD,IACEA,MAAMC,GAAN,CACGC,IAAD,IACE,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,KAAKE,IAAd,CAAf,EAAoCF,KAAKG,UAAzC,EAAqDH,KAAKI,KAA1D,CAFJ,CAFG,EAMJC,GAAD,IAAS;AACP,kBAAM,IAAId,oBAAJ,CACJ,2DADI,CAAN;AAGD,WAVI,CAAP;AAYD;;AAEKiB,iCAAN,GAAkC;AAAA;;AAAA;AAChC,gBAAI;AACF,oBAAMC,UAAU,MAAMC,QAAQC,GAAR,CAAY,CAChC,MAAKhB,wBAAL,EADgC,EAEhC,MAAKW,gCAAL,EAFgC,EAGhC,MAAKC,iCAAL,EAHgC,CAAZ,CAAtB;;AAMA,qBAAOE,QACJG,MADI,CACG,UAACC,GAAD,EAAMC,KAAN;AAAA,uBAAgBD,IAAIE,MAAJ,CAAWD,KAAX,CAAhB;AAAA,eADH,EACsC,EADtC,EAEJE,IAFI,CAEC,UAACC,CAAD,EAAIC,CAAJ;AAAA,uBAAUA,EAAEhB,IAAF,CAAOiB,OAAP,KAAmBF,EAAEf,IAAF,CAAOiB,OAAP,EAA7B;AAAA,eAFD,CAAP;AAGD,aAVD,CAUE,OAAOd,GAAP,EAAY;AACZ,oBAAKe,SAAL,CAAeC,KAAf,GAAuB,kDAAvB;AACD;AAb+B;AAcjC;AAhE4B,O","file":"NegociacaoService.js","sourcesContent":["import { HttpService } from '../../util/HttpService.js'\nimport { Negociacao } from './Negociacao.js'\nimport { ApplicationException } from '../../util/ApplicationException.js'\nexport class NegociacaoService {\n  constructor() {\n    this._http = new HttpService()\n  }\n\n  obterNegociacoesDaSemana() {\n    return this._http.get('negociacoes/semana').then(\n      (dados) =>\n        dados.map(\n          (dado) =>\n            new Negociacao(new Date(dado.data), dado.quantidade, dado.valor),\n        ),\n      (err) => {\n        throw new ApplicationException(\n          'Não foi possível obter as negociações da semana',\n        )\n      },\n    )\n  }\n\n  obterNegociacoesDaSemanaAnterior() {\n    return this._http.get('negociacoes/anterior').then(\n      (dados) =>\n        dados.map(\n          (dado) =>\n            new Negociacao(new Date(dado.data), dado.quantidade, dado.valor),\n        ),\n      (err) => {\n        throw new ApplicationException(\n          'Não foi possível obter as negociações da semana anterior',\n        )\n      },\n    )\n  }\n\n  obterNegociacoesDaSemanaRetrasada() {\n    return this._http.get('negociacoes/retrasada').then(\n      (dados) =>\n        dados.map(\n          (dado) =>\n            new Negociacao(new Date(dado.data), dado.quantidade, dado.valor),\n        ),\n      (err) => {\n        throw new ApplicationException(\n          'Não foi possível obter as negociações da semana retrasada',\n        )\n      },\n    )\n  }\n\n  async obtemNegociacoesDoPeriodo() {\n    try {\n      const periodo = await Promise.all([\n        this.obterNegociacoesDaSemana(),\n        this.obterNegociacoesDaSemanaAnterior(),\n        this.obterNegociacoesDaSemanaRetrasada(),\n      ])\n\n      return periodo\n        .reduce((acc, array) => acc.concat(array), [])\n        .sort((a, b) => b.data.getTime() - a.data.getTime())\n    } catch (err) {\n      this._mensagem.texto = 'Não foi possível obter as negociações do período'\n    }\n  }\n}\n"]}